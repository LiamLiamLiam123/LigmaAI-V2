<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LigmaAI</title>

<style>
body { background: #0c1a0c; color: #e4ffe4; display: flex; flex-direction: column; height: 100vh; font-family: sans-serif; margin:0; }
header { padding: 15px; text-align: center; font-size: 22px; background: #0f2f0f; border-bottom: 2px solid #1f4d1f; color:#8aff8a; }
#chat { flex: 1; overflow-y: auto; padding: 20px; }
.msg { max-width: 70%; margin-bottom: 15px; padding: 12px 16px; border-radius: 12px; line-height: 1.5; white-space: pre-wrap; }
.user { background: #33aa33; color: black; margin-left: auto; }
.bot { background: #143614; color: #ccffcc; }
#inputBox { display: flex; padding: 15px; background: #0f2f0f; border-top: 2px solid #1f4d1f; }
#input { flex: 1; padding: 12px; border-radius: 10px; border: 2px solid #1f4d1f; background: #0c1a0c; color: #e4ffe4; font-size: 15px; }
#send { margin-left: 10px; padding: 12px 20px; background: #33aa33; border: none; border-radius: 10px; cursor: pointer; font-size: 15px; font-weight: bold; }
#send:hover { background: #40c040; }
</style>
</head>

<body>

<header>LigmaAI</header>
<div id="chat"></div>

<div id="inputBox">
  <input id="input" type="text" placeholder="Send a messageâ€¦" />
  <button id="send">Send</button>
</div>

<script>
/* ================================
   ðŸ”‘ PUT YOUR HF TOKEN HERE
   ================================ */
const HF_TOKEN = "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";

/* ================================
   SYSTEM PROMPT
   ================================ */
const SYSTEM_PROMPT =
"You are LigmaAI, a friendly and helpful assistant made by Liam Stephenson. " +
"You must NEVER mention Google. Use 'Ligma' instead. Be polite and clear.";

/* ================================
   CHAT MEMORY
   ================================ */
let conversation = [
  { role: "system", content: SYSTEM_PROMPT }
];

const chat = document.getElementById("chat");
const input = document.getElementById("input");
const send = document.getElementById("send");

function addMessage(text, type) {
  const div = document.createElement("div");
  div.className = "msg " + type;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

/* ================================
   HUGGING FACE VIA PUBLIC PROXY
   ================================ */
async function askAI() {
  try {
    const res = await fetch(
      "https://corsproxy.io/?https://api-inference.huggingface.co/v1/chat/completions",
      {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${HF_TOKEN}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          model: "HuggingFaceH4/zephyr-7b-beta",
          messages: conversation,
          max_tokens: 200,
          temperature: 0.7
        })
      }
    );

    const data = await res.json();
    return data?.choices?.[0]?.message?.content || "âš ï¸ No response.";

  } catch (e) {
    console.error(e);
    return "âš ï¸ Network error (public proxy blocked or rate-limited).";
  }
}

/* ================================
   SEND MESSAGE
   ================================ */
send.onclick = async () => {
  const text = input.value.trim();
  if (!text) return;
  input.value = "";

  addMessage(text, "user");
  conversation.push({ role: "user", content: text });

  const thinking = document.createElement("div");
  thinking.className = "msg bot";
  thinking.textContent = "â€¦thinkingâ€¦";
  chat.appendChild(thinking);

  const reply = await askAI();

  thinking.remove();
  addMessage(reply, "bot");
  conversation.push({ role: "assistant", content: reply });
};

input.addEventListener("keydown", e => {
  if (e.key === "Enter") send.click();
});
</script>

</body>
</html>
