<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LigmaAI</title>

<style>
body { background:#0c1a0c; color:#e4ffe4; display:flex; flex-direction:column; height:100vh; margin:0; font-family:sans-serif; }
header { padding:15px; text-align:center; font-size:22px; background:#0f2f0f; border-bottom:2px solid #1f4d1f; color:#8aff8a; }
#chat { flex:1; overflow-y:auto; padding:20px; }
.msg { max-width:70%; margin-bottom:15px; padding:12px 16px; border-radius:12px; white-space:pre-wrap; }
.user { background:#33aa33; color:black; margin-left:auto; }
.bot { background:#143614; color:#ccffcc; }
#inputBox { display:flex; padding:15px; background:#0f2f0f; border-top:2px solid #1f4d1f; }
#input { flex:1; padding:12px; border-radius:10px; border:2px solid #1f4d1f; background:#0c1a0c; color:#e4ffe4; }
#send { margin-left:10px; padding:12px 20px; background:#33aa33; border:none; border-radius:10px; font-weight:bold; cursor:pointer; }
</style>
</head>

<body>

<header>LigmaAI</header>
<div id="chat"></div>

<div id="inputBox">
  <input id="input" placeholder="Send a message…">
  <button id="send">Send</button>
</div>

<script>
const SYSTEM_PROMPT =
"You are LigmaAI, a friendly and helpful assistant made by Liam Stephenson. " +
"Never mention Google. Use Ligma instead.";

let history = [];

const chat = document.getElementById("chat");
const input = document.getElementById("input");
const send = document.getElementById("send");

function addMessage(text, type) {
  const d = document.createElement("div");
  d.className = "msg " + type;
  d.textContent = text;
  chat.appendChild(d);
  chat.scrollTop = chat.scrollHeight;
}

async function askAI(prompt) {
  const fullPrompt =
    SYSTEM_PROMPT + "\n\nConversation:\n" +
    history.map(m => `${m.role}: ${m.text}`).join("\n") +
    "\nuser: " + prompt + "\nassistant:";

  const url =
    "https://text.pollinations.ai/" +
    encodeURIComponent(fullPrompt);

  const res = await fetch(url);
  return await res.text();
}

send.onclick = async () => {
  const text = input.value.trim();
  if (!text) return;
  input.value = "";

  addMessage(text, "user");
  history.push({ role:"user", text });

  const thinking = document.createElement("div");
  thinking.className = "msg bot";
  thinking.textContent = "…thinking…";
  chat.appendChild(thinking);

  try {
    const reply = await askAI(text);
    thinking.remove();
    addMessage(reply, "bot");
    history.push({ role:"assistant", text: reply });
  } catch {
    thinking.remove();
    addMessage("⚠️ Network error", "bot");
  }
};

input.addEventListener("keydown", e => {
  if (e.key === "Enter") send.click();
});
</script>

</body>
</html>
